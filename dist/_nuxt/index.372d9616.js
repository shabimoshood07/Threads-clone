import{K as E,J as j,I as V,r as v,c as B,m as o,q as f,s as e,t as P,L as l,M as L,N,O as b,v as x,P as y,y as M,Q as O,R as U,S as C,T as S,d as R,o as z,C as I,U as F,x as T,V as q,W as H,n as J}from"./entry.738b3ba1.js";import K from"./MainLayout.df5fb893.js";import"./threads-logo.a0990df6.js";const Q={class:"z-50 bottom-0 h-full w-full"},W={class:"py-2 w-full"},Z={class:"flex items-center justify-between"},G={class:"flex items-center text-white"},X=["src"],Y={class:"ml-2 font-semibold text-[18px]"},ee=["disabled"],te={key:0,class:"absolute border border-gray-600 right-0 z-20 mt-1 rounded"},se=e("div",null,"Delete",-1),le={class:"flex relative w-full items-center"},oe=e("div",{class:"w-[42px] mx-auto"},[e("div",{class:"absolute ml-4 mt-1 top-0 w-[1px] bg-gray-700 h-full"})],-1),ae={class:"bg-black rounded-lg w-[calc(100%-50px)] text-sm font-light"},ie={class:"py-2 text-gray-300"},ne=["src"],re={class:"absolute mt-2 w-full ml-2"},ce=["disabled"],ue={class:"relative text-sm text-gray-500"},de={key:0},fe={key:1},me=O('<div class="relative inline-block text-gray-500 pt-1 pb-1.5"><div class="flex items-center"><div class="flex items-center flex-wrap text-white gap-1 w-[42px]"><div class="flex gap-0.5"><img src="https://picsum.photos/id/202/50" class="rounded-full h-[14px] mt-2" alt=""><img src="https://picsum.photos/id/223/50" class="rounded-full h-[17px]" alt=""></div><div class="flex items-center"><img src="https://picsum.photos/id/99/50" class="rounded-full h-[11px] ml-4" alt=""></div></div></div></div><div class="h-[1px] bg-gray-800 w-full mt-3"></div>',2),pe={__name:"Post",props:{post:Object},emits:["isDeleted"],setup(i,{emit:m}){const t=i,u=E();let d=U();const a=j(),_=V();let n=v(!1),r=v(!1),p=v(!1);const w=B(()=>{if(!a.value)return;let c=!1;return t.post.likes.forEach(s=>{if(s.userId==a.value.identities[0].user_id&&s.postId==t.post.id)return c=!0}),c}),k=async(c,s)=>{if(confirm("Are you sure you want to delete post"))try{n.value=!1,p.value=!0;const{data:g,error:Ie}=await _.storage.from("thread-clone-files").remove([s]);await C(`/api/delete-post/${c}`,{method:"DELETE"},"$BjiLPPTCDE"),m("isDeleted",!0)}catch(g){console.log(g),p.value=!1}},$=async c=>{r.value=!0;try{await C("/api/like-post",{method:"POST",body:{userId:a.value.identities[0].user_id,postId:c}},"$zo9BaVrdAh"),await u.getAllPosts(),r.value=!1}catch(s){console.log(s),r.value=!1}},A=async c=>{r.value=!0;try{await C(`/api/unlike-post/${c}`,{method:"DELETE"},"$VAHjaIgvZw"),await u.getAllPosts(),r.value=!1}catch(s){console.log(s),r.value=!1}},D=async()=>{let c=null;if(t.post.likes.length<1)return $(t.post.id),null;if(t.post.likes.forEach(s=>{s.userId==a.value.identities[0].user_id&&s.postId===t.post.id&&(c=s)}),c)return A(c.id),null;$(t.post.id)};return(c,s)=>{const h=S;return o(),f("div",Q,[e("div",W,[e("div",Z,[e("div",G,[e("img",{class:"rounded-full h-[35px]",src:i.post.image},null,8,X),e("div",Y,P(i.post.name),1)]),l(a)&&l(a).identities&&l(a).identities[0].user_id===i.post.userId?(o(),f("div",{key:0,onClick:s[1]||(s[1]=g=>L(n)?n.value=!l(n):n=!l(n)),class:"relative"},[e("button",{disabled:l(p),class:N(["flex items-center text-white p-1 h-[24px] hover:bg-gray-800 rounded-full cursor-pointer w-[24px]",l(n)?"bg-gray-800":""])},[l(p)?(o(),b(h,{key:1,name:"eos-icons:bubble-loading",color:"#ffffff",size:"18"})):(o(),b(h,{key:0,name:"bi:three-dots",color:"#ffffff",size:"18"}))],10,ee),l(n)?(o(),f("div",te,[e("button",{onClick:s[0]||(s[0]=g=>k(i.post.id,i.post.picture)),class:"flex items-center rounded gap-2 text-red-500 justify-between bg-black w-full pl-4 pr-3 py-1 hover:bg-gray-800"},[se,x(h,{name:"solar:trash-bin-trash-broken",size:"20"})])])):y("",!0)])):y("",!0)]),e("div",le,[oe,e("div",ae,[e("div",ie,P(i.post.text),1),i.post&&i.post.picture?(o(),f("img",{key:0,class:"mx-auto w-full rounded mt-2 pr-2",src:l(d).public.bucketUrl+i.post.picture},null,8,ne)):y("",!0),e("div",re,[e("button",{disabled:l(r),class:"flex items-center gap-1",onClick:s[2]||(s[2]=g=>D())},[l(w)?(o(),b(h,{key:1,class:"p-1 text-red-500 hover:bg-gray-800 rounded-full cursor-pointer",name:"mdi:cards-heart",size:"28"})):(o(),b(h,{key:0,class:"p-1 text-white hover:bg-gray-800 rounded-full cursor-pointer",name:"mdi:cards-heart-outline",size:"28"}))],8,ce),e("div",ue,[e("div",null,[l(r)?(o(),f("span",fe,[x(h,{size:"13",color:"#ffffff",name:"eos-icons:bubble-loading"})])):(o(),f("span",de,P(i.post.likes.length),1)),M(" Likes ")])])])])])]),me])}}},he=pe,ve=R({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(i,{slots:m,attrs:t}){const u=v(!1);return z(()=>{u.value=!0}),d=>{var r;if(u.value)return(r=m.default)==null?void 0:r.call(m);const a=m.fallback||m.placeholder;if(a)return a();const _=d.fallback||d.placeholder||"",n=d.fallbackTag||d.placeholderTag||"span";return f(n,t,_)}}}),_e={id:"IndexPage",class:"w-full overflow-auto"},xe={class:"mx-auto max-w-[500px] overflow-hidden"},ge={id:"Posts",class:"px-4 max-w-[600px] mx-auto"},be={key:1},ye={key:0,class:"mt-20 w-full flex items-center justify-center mx-auto"},ke={class:"text-white mx-auto flex flex-col items-center justify-center"},we=e("h1",{class:"w-full"},"Loading...",-1),$e={key:1,class:"mt-20 w-full flex items-center justify-center mx-auto"},Pe={class:"text-white mx-auto flex flex-col items-center justify-center"},Ce=e("h1",{class:"w-full"},"Make the first post",-1),je={__name:"index",setup(i){const m=j(),t=E();let u=v([]),d=v(!1),a=v(!1);return I(()=>{if(!m.value)return J("/auth")}),F(async()=>{try{a.value=!0,await t.getAllPosts(),a.value=!1}catch(_){console.log(_)}}),z(()=>{I(()=>{u.value=t.posts,t.posts&&t.posts.length>=1?d.value=!0:d.value=!1})}),z(()=>{I(()=>{u.value=t.posts,t.posts&&t.posts.length>=1?d.value=!0:d.value=!1})},{deep:!0}),(_,n)=>{const r=he,p=S,w=ve;return o(),b(K,null,{default:T(()=>[e("div",_e,[e("div",xe,[e("div",ge,[l(d)?(o(!0),f(H,{key:0},q(l(u),k=>(o(),f("div",{key:k,class:"text-white"},[x(r,{post:k,onIsDeleted:n[0]||(n[0]=$=>L(u)?u.value=l(t).getAllPosts():u=l(t).getAllPosts())},null,8,["post"])]))),128)):(o(),f("div",be,[x(w,null,{default:T(()=>[l(a)?(o(),f("div",ye,[e("div",ke,[x(p,{name:"eos-icons:bubble-loading",size:"50",color:"#ffffff"}),we])])):y("",!0),l(a)?y("",!0):(o(),f("div",$e,[e("div",Pe,[x(p,{name:"tabler:mood-empty",size:"50",color:"#ffffff"}),Ce])]))]),_:1})]))])])])]),_:1})}}};export{je as default};
